<!DOCTYPE html>
<html>

<head>
    <title>
        WPICTF 2020 | Nischay
    </title>
    <meta charset="utf-8" />
    <!--<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />-->
    <!--[if lte IE 8
        ]><script src="/assets/js/ie/html5shiv.js"></script
    ><![endif]-->
    <link rel="stylesheet" href="/assets/css/main.css" />
    <link rel="stylesheet" href="/assets/css/gruvbox.css" />
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/brands.css">-->
    <!--[if lte IE 9
        ]><link rel="stylesheet" href="/assets/css/ie9.css"
    /><![endif]-->
    <!--[if lte IE 8
        ]><link rel="stylesheet" href="/assets/css/ie8.css"
    /><![endif]-->
</head>


<body>
    <!-- Header -->
<!--<header id="header">
	<a href="/" class="logo"><strong>Nischay</strong> <span></span></a>-->
</header>
<!--
<nav id="menu">
	<ul class="links">
        
		    
		
		    
		
		    
		
		    
		
		    
		
		    
		
		    
		
		    
		
		    
		        <li><a href="/">Home</a></li>
	    	
		
		    
		
		
		    
		
		    
		
		    
		
		    
		        <li><a href="/all_posts.html">All posts</a></li>
		    
		
		    
		        <li><a href="/arch.html">Linux good</a></li>
		    
		
		    
		        <li><a href="/courses.html">Course-related</a></li>
		    
		
		    
		        <li><a href="/ctf.html">CTF</a></li>
		    
		
		    
		
		    
		        <li><a href="/privacy.html">Privacy</a></li>
		    
		
	</ul>
</nav>-->

<!-- Sidebar -->
<nav id="menu">
	<div class="sidebar">
        
		    
		
		    
		
		    
		
		    
		
		    
		
		    
		
		    
		
		    
		
		    
		        <a href="/">Home</a>
	    	
		
		    
		
		
		    
		
		    
		
		    
		
		    
		        <a href="/all_posts.html">All posts</a>
		    
		
		    
		        <a href="/arch.html">Linux good</a>
		    
		
		    
		        <a href="/courses.html">Course-related</a>
		    
		
		    
		        <a href="/ctf.html">CTF</a>
		    
		
		    
		
		    
		        <a href="/privacy.html">Privacy</a>
		    
		

</nav>

<!-- Div with one image in it lol -->
<!--
   -<div class="name" align="center"><img src="/assets/images/name.png" href="/"></div>
	 -->
<!-- font name: dos rebel -->
<div class="name" align="center" >
        <pre>
             ███                   █████                          
            ░░░                   ░░███                           
 ████████   ████   █████   ██████  ░███████    ██████   █████ ████
░░███░░███ ░░███  ███░░   ███░░███ ░███░░███  ░░░░░███ ░░███ ░███ 
 ░███ ░███  ░███ ░░█████ ░███ ░░░  ░███ ░███   ███████  ░███ ░███ 
 ░███ ░███  ░███  ░░░░███░███  ███ ░███ ░███  ███░░███  ░███ ░███ 
 ████ █████ █████ ██████ ░░██████  ████ █████░░████████ ░░███████ 
░░░░ ░░░░░ ░░░░░ ░░░░░░   ░░░░░░  ░░░░ ░░░░░  ░░░░░░░░   ░░░░░███ 
                                                         ███ ░███ 
                                                        ░░██████  
                                                         ░░░░░░   
        </pre>
</div>
<div id="color-toggle">
			<input type="checkbox" id="color-mode">
			<label for="color-mode" class="theme-switch">
				<div class="switch">
					<div class="switch-handle">
						<span class="crater crater-1"></span>
						<span class="crater crater-2"></span>
						<span class="crater crater-3"></span>
					</div>
					<div class="star star-1"></div>
					<div class="star star-2"></div>
					<div class="star star-3"></div>
					<div class="star star-4"></div>
					<div class="star star-5"></div>
					<div class="star star-6"></div>
				</div>
			</label>
		</div>
		<script>
			// Initialize theme from localStorage on page load
			document.addEventListener('DOMContentLoaded', function() {
				var colorMode = document.getElementById('color-mode');
				var storedTheme = localStorage.getItem('theme');

				// Apply the stored theme preference if it exists
				if (storedTheme === 'dark') {
					colorMode.checked = true;
					document.body.classList.add('dark-theme');
				} else if (storedTheme === 'light') {
					colorMode.checked = false;
					document.body.classList.remove('dark-theme');
				}

				// Listen for changes to the checkbox
				colorMode.addEventListener('change', function() {
					if (this.checked) {
						// Dark theme
						document.body.classList.add('dark-theme');
						localStorage.setItem('theme', 'dark');
					} else {
						// Light theme
						document.body.classList.remove('dark-theme');
						localStorage.setItem('theme', 'light');
					}
				});
			});
		</script>
		<style>
			.theme-switch {
				display: inline-block;
				height: 34px;
				position: relative;
				width: 60px;
				cursor: pointer;
			}

			.switch {
				background-color: #343D5B;
				border-radius: 1000px;
				position: relative;
				height: 100%;
				width: 100%;
				transition: background-color 0.3s ease;
				overflow: hidden;
			}

			.switch-handle {
				background-color: #FFD000;
				border-radius: 50%;
				height: 26px;
				width: 26px;
				position: absolute;
				left: 4px;
				top: 4px;
				transition: all 0.3s ease;
			}

			.crater {
				background-color: #E8BB63;
				border-radius: 50%;
				position: absolute;
				opacity: 0;
				transition: opacity 0.2s ease;
			}

			.crater-1 {
				height: 8px;
				width: 8px;
				top: 8px;
				left: 9px;
			}

			.crater-2 {
				height: 6px;
				width: 6px;
				top: 16px;
				left: 15px;
			}

			.crater-3 {
				height: 5px;
				width: 5px;
				top: 6px;
				left: 17px;
			}

			.star {
				background-color: #fff;
				border-radius: 50%;
				position: absolute;
				transition: all 0.3s ease;
				opacity: 0;
			}

			.star-1 {
				width: 3px;
				height: 3px;
				top: 8px;
				left: 35px;
			}

			.star-2 {
				width: 2px;
				height: 2px;
				top: 14px;
				left: 45px;
			}

			.star-3 {
				width: 2px;
				height: 2px;
				top: 24px;
				left: 40px;
			}

			.star-4 {
				width: 2px;
				height: 2px;
				top: 18px;
				left: 32px;
			}

			.star-5 {
				width: 1px;
				height: 1px;
				top: 10px;
				left: 48px;
			}

			.star-6 {
				width: 2px;
				height: 2px;
				top: 22px;
				left: 50px;
			}

			#color-mode:checked + .theme-switch .switch {
				background-color: #749DD6;
			}

			#color-mode:checked + .theme-switch .switch-handle {
				background-color: #F4F4F2;
				transform: translateX(26px);
			}

			#color-mode:checked + .theme-switch .crater {
				opacity: 1;
			}

			#color-mode:checked + .theme-switch .star {
				opacity: 1;
				transform: scale(1) rotate(45deg);
			}

			/* Add a subtle pulse animation to the stars */
			@keyframes pulse {
				0% { transform: scale(1); }
				50% { transform: scale(1.2); }
				100% { transform: scale(1); }
			}

			#color-mode:checked + .theme-switch .star-1 {
				animation: pulse 2s infinite;
			}

			#color-mode:checked + .theme-switch .star-2 {
				animation: pulse 2.5s infinite;
			}

			#color-mode:checked + .theme-switch .star-3 {
				animation: pulse 1.8s infinite;
			}

			/* Hover effect */
			.theme-switch:hover .switch {
				box-shadow: 0 0 8px rgba(255, 255, 255, 0.4);
			}

			.theme-switch:hover .switch-handle {
				box-shadow: 0 0 5px rgba(255, 255, 255, 0.4);
			}
		</style>
	</div>



<!-- Main -->
<div id="main" class="alt main">

<!-- One -->
<section id="one">
	<div class="inner">
		<header class="major">
			<h1><center>WPICTF 2020</center></h1>
		</header>
		<span class="description"><center><i><h3>Writeups of stuff that I solved for WPICTF</h3></span></i></center>
		
		<h1 id="danger-live-and-malicious-code">danger-Live-and-Malicious-Code</h1>

<h2 id="question">Question</h2>

<p>Like the title says, this challenge is dangerous and contains live malware.</p>

<h2 id="the-malicious-code">The malicious code:</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var a = ['ps:','cte','5df','se_','toS','ing','tri','sub','lac','ryt','d}.','cod','pro','_no','ran','ing','dom','str','ete','rep'];function abc(def) {
popupWindow = window.open( def,'popUpWindow','height=666,width=666,left=666,top=666') }(function(c, d) {var e = function(f) {while (--f) {c['push'](c['shift']());}};e(++d);}(a, 0xa8));var b = function(c, d) {c = c - 0x0;var e = a[c];return e;};var c = 'htt' + b('0xc') + '//t' + b('0x1') + b('0xe') + 'xc-' + 'rWP' + 'I';var d = '{Oh' + b('0x5') + b('0xf') + b('0x4') + b('0x3') + b('0x7') + '_d';var e = b('0xa') + b('0xd') + b('0x2') + 'net' + '/';var f = Math[b('0x6') +
b('0x8')]()[b('0x10') + b('0x12') + 'ng'](0x6)[b('0x13') + b('0x9') + b('0x11')](0x2, 0xf) + Math['ran' + 'dom']()[b('0x10') + b('0x12') + 'ng'](0x10)[b('0x13') + b('0x9') + b('0x11')](0x2, 0xf);var g = Math['ran' + 'dom']()[b('0x10') +
b('0x12') + 'ng'](0x24)[b('0x13') + b('0x9') + b('0x11')](0x2, 0xf) + Math[b('0x6') + b('0x8')]()['toS' + b('0x12') + 'ng'](0x24)[b('0x13') + b('0x9') + b('0x11')](0x2, 0xf);/*location[b('0xb') + b('0x0') + 'e'](c + d + e + '?' + f + '=' + g);*/for(var i=1;i===i;i++){abc(self.location,'_blank');}
</code></pre></div></div>

<h2 id="what-i-did">What I did:</h2>

<p>So I had to first of all, beautify the code, so that I could make any sense out of it.</p>

<p>That’s what I did. Beautified code:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var a = ['ps:', 'cte', '5df', 'se_', 'toS', 'ing', 'tri', 'sub', 'lac', 'ryt', 'd}.', 'cod', 'pro', '_no', 'ran', 'ing', 'dom', 'str', 'ete', 'rep'];

function abc(def) {
    popupWindow = window.open(def, 'popUpWindow', 'height=666,width=666,left=666,top=666')
}(function(c, d) {
    var e = function(f) {
        while (--f) {
            c['push'](c['shift']());
        }
    };
    e(++d);
}(a, 0xa8));
var b = function(c, d) {
    c = c - 0x0;
    var e = a[c];
    return e;
};
var c = 'htt' + b('0xc') + '//t' + b('0x1') + b('0xe') + 'xc-' + 'rWP' + 'I';
var d = '{Oh' + b('0x5') + b('0xf') + b('0x4') + b('0x3') + b('0x7') + '_d';
var e = b('0xa') + b('0xd') + b('0x2') + 'net' + '/';
var f = Math[b('0x6') + b('0x8')]()[b('0x10') + b('0x12') + 'ng'](0x6)[b('0x13') + b('0x9') + b('0x11')](0x2, 0xf) + Math['ran' + 'dom']()[b('0x10') + b('0x12') + 'ng'](0x10)[b('0x13') + b('0x9') + b('0x11')](0x2, 0xf);
var g = Math['ran' + 'dom']()[b('0x10') + b('0x12') + 'ng'](0x24)[b('0x13') + b('0x9') + b('0x11')](0x2, 0xf) + Math[b('0x6') + b('0x8')]()['toS' + b('0x12') + 'ng'](0x24)[b('0x13') + b('0x9') + b('0x11')](0x2, 0xf); /*location[b('0xb') + b('0x0') + 'e'](c + d + e + '?' + f + '=' + g);*/
for (var i = 1; i === i; i++) {
    abc(self.location, '_blank');
}
</code></pre></div></div>

<p>Now, you don’t really need to know what’s happening behind the scenes, but you can just change the function abc to just console.log all the variables. The flag is split between c,d, and e, so that’s all you need.
Just changing the code to console.log variables and changing the for loop, so that it doesn’t run forever, you can get the flag.</p>

<h2 id="flag">FLAG</h2>
<p>WPI{Oh_nose_procoding_detected}</p>


	</div>
</section>

</div>

    <!-- Contact -->
<script>
// Get the toggle button
const toggleButton = document.getElementById('dark-mode-toggle');

if (localStorage.getItem('dark-mode') === 'enabled') {
    document.body.classList.add('dark-mode');
    toggleButton.classList.add('pressed');
}

toggleButton.addEventListener('click', function() {
    if (document.body.classList.contains('dark-mode')) {
        document.body.classList.remove('dark-mode');
        toggleButton.classList.remove('pressed');
        localStorage.setItem('dark-mode', 'disabled');
    } else {
        document.body.classList.add('dark-mode');
        toggleButton.classList.add('pressed');
        localStorage.setItem('dark-mode', 'enabled');
    }
});
</script>
<section class="contact">
	<div class="inner">
		<section>
		<h2> Contact me </h2>
			<form action="https://formkeep.com/f/89c23290a542"
			accept-charset="UTF-8"
			enctype="multipart/form-data"
			method="POST">
				<div class="field half first">
					<label for="name">Name</label>
					<input type="text" name="name" id="name" />
				</div>
				<div class="field half">
					<label for="email">Email</label>
					<input type="text" name="_replyto" id="email" />
				</div>
				<div class="field">
					<label for="message">Message</label>
					<textarea name="message" id="message" rows="6"></textarea>
				</div>
				<ul class="actions">
					<input type="submit" value="Send Message" class="special" />
					<input type="reset" value="Clear" class="special"/>
				</ul>
			</form>
		</section>
<!--		<section class="split">
			<section>
				<div class="contact-method">
					<span class="icon alt fa-envelope"></span>
					<h3>Email</h3>
					<a href="#">hegdenischay@gmail.com</a>
				</div>
			</section>
			<section>
				<div class="contact-method">
					<span class="icon alt fa-home"></span>
					<h3>Address</h3>
					<span>
					
					
					    Bengaluru,
					
					
					    KA
					
					
					    560035<br />
					
					
					    India
					
					</span>
				</div>
			</section>
		</section>-->
	</div>
</section>

<!-- Footer -->
	<footer id="footer" class="socials">
	<h2> Socials </h2>
		<div class="inner">
			<ul class="icons">
				
				<li><a href="https://twitter.com/thatloststudent" target="_blank"><i class="icon alt twitter"><span class="label">Twitter</span></i></a></li>
				
				
				<li><a href="https://infosec.exchange/@thatloststudent" class="icon alt mastodon" target="_blank"><span class="label">Fediverse</span></a></li>
				
				
				<li><a href="https://matrix.to/#/&commat;nischay&colon;nischay&period;me" class="icon alt matrix" target="_black"><img src="/assets/images/icons/matrix.svg" style="width: 40px; max-height:20px;"><span class="label">Matrix</span></a></li>
				
				
				
				
				
				
				
				
				<li><a href="https://github.com/hegdenischay" class="icon alt github" target="_blank"><span class="label">GitHub</span></a></li>
				
				
				
				<li><a href="https://www.linkedin.com/in/nischay-hegde-ba9030119" class="icon alt linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
				
			</ul>
		</div>
	</footer>

</div>


</body>

</html>
